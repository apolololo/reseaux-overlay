<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="google-site-verification" content="wsa3hgo8nByeN7Dol9wAqijcqjokRiZgi7GTXYS9vS4" />
  <meta name="google-adsense-account" content="ca-pub-4235710569572969">
  <meta name="description" content="APO Overlays - Créez des overlays professionnels pour vos streams Twitch. Personnalisez votre stream avec des overlays de haute qualité, des alertes et des widgets." />
  <meta name="keywords" content="overlay twitch, stream overlay, twitch alerts, streaming tools, APO overlays" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-3E3FX0VG3Z"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-3E3FX0VG3Z');
  </script>
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4235710569572969" crossorigin="anonymous"></script>
  <title>APO Overlays - Overlays Professionnels pour Twitch</title>
  <link rel="icon" type="image/png" href="/icon.png">
  <link rel="stylesheet" href="./src/styles/main.css" />
  <link rel="stylesheet" href="./src/styles/app.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    #app { display: none; }
    .loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-dark);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .loading-spinner {
      width: 40px;
      height: 40px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-left-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    .privacy-link {
      position: fixed;
      bottom: 1rem;
      right: 1rem;
      color: var(--text-secondary);
      text-decoration: none;
      font-size: 0.9rem;
      padding: 0.5rem 1rem;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 6px;
      transition: all 0.3s ease;
    }
    .privacy-link:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: translateY(-2px);
    }
    .preview-options {
      display: flex;
      flex-direction: column;
      gap: 10px;
      padding: 10px;
      background: var(--bg-dark);
      border-radius: 8px;
      width: 100%;
    }
    .background-options {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    footer {
      margin-top: 30px;
      padding: 20px;
      text-align: center;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }
    .footer-links a {
      color: var(--text-secondary);
      text-decoration: none;
      margin: 0 10px;
      transition: color 0.3s ease;
    }
    .footer-links a:hover {
      color: var(--primary);
      text-decoration: underline;
    }
    .separator {
      color: var(--text-secondary);
    }
  </style>
</head>
<body>
  <div class="loading-screen">
    <div class="loading-spinner"></div>
  </div>

  <div id="app">
    <div class="overlay-list">
      <div class="header-container">
        <h2>Overlays</h2>
        <div class="user-info-container">
          <div id="twitch-info" class="twitch-info">
            <!-- Les informations utilisateur seront insérées ici -->
          </div>
          <button id="logout-button" class="logout-button">
            <svg viewBox="0 0 24 24" width="18" height="18">
              <path fill="currentColor" d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
            </svg>
            <span>Déconnexion</span>
          </button>
        </div>
      </div>
      <ul>
        <li class="overlay-item active" data-url="src/overlays/apo/overlay.html" data-size="800x200">
          Réseaux & Code
        </li>
        <li class="overlay-item" data-url="src/overlays/starting/overlay.html" data-size="1920x1080">
          Starting Soon
        </li>
        <li class="folder-item">
          <div class="folder-header">
            <span>Pause</span>
            <svg class="folder-icon" viewBox="0 0 24 24" width="24" height="24">
              <path fill="currentColor" d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
            </svg>
          </div>
          <ul class="folder-content">
            <li class="overlay-item" data-url="src/overlays/brb/overlay.html" data-size="1920x1080">
              Pause Standard
            </li>
            <li class="overlay-item" data-url="src/overlays/brb/overlay-video.html" data-size="1920x1080">
              Pause avec Zone Vidéo
            </li>
          </ul>
        </li>
        <li class="overlay-item" data-url="src/overlays/end/overlay.html" data-size="1920x1080">
          Fin du Stream
        </li>
        <li class="overlay-item" data-url="src/overlays/game-status/overlay.html" data-size="1920x1080">
          Status de Jeu
        </li>
        <li class="overlay-item" data-url="src/overlays/followers-goal/overlay.html" data-size="500x300" data-config="src/overlays/followers-goal/config.html">
          Followers Goal
        </li>
        <li class="folder-item">
          <div class="folder-header">
            <span>Maps</span>
            <svg class="folder-icon" viewBox="0 0 24 24" width="24" height="24">
              <path fill="currentColor" d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/>
            </svg>
          </div>
          <ul class="folder-content">
            <li class="overlay-item" data-url="src/overlays/maps/overlay.html" data-size="1920x1080">
              Box Fights & Zone Wars
            </li>
          </ul>
        </li>
      </ul>
    </div>
    
    <div class="preview-section">
      <div class="preview-options">
        <div class="background-options">
          <label>Fond de preview :</label>
          <div class="background-controls">
            <input type="color" id="bg-color" value="#000000" title="Couleur de fond">
            <button id="bg-transparent" title="Fond transparent">
              <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M12 2L2 12l10 10 10-10L12 2zM4.83 12L12 19.17 19.17 12 12 4.83 4.83 12z"/>
              </svg>
            </button>
            <input type="file" id="bg-image" accept="image/*" hidden>
            <button id="bg-image-btn" title="Image de fond">
              <svg viewBox="0 0 24 24" width="24" height="24">
                <path fill="currentColor" d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div class="preview-container">
        <div class="preview-background">
          <iframe id="overlay-preview" src="/src/overlays/apo/overlay.html"></iframe>
        </div>
      </div>

      <div class="copy-info">
        <button id="copy-url">
          <svg viewBox="0 0 24 24" width="18" height="18">
            <path fill="currentColor" d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/>
          </svg>
          Copier l'URL pour OBS
        </button>
        <span class="size-info">Taille recommandée : 800x200</span>
      </div>
    </div>
  </div>

  <a href="/src/privacy.html" class="privacy-link">Politique de confidentialité</a>

  <script type="module" src="./src/js/main.js"></script>
  <script type="module">
    document.addEventListener('DOMContentLoaded', () => {
      const app = document.getElementById('app');
      const loadingScreen = document.querySelector('.loading-screen');

      const checkAuth = () => {
        const token = localStorage.getItem('twitch_token');
        const expiresAt = localStorage.getItem('twitch_expires_at');
        const userData = localStorage.getItem('twitch_user');
        
        if (!token || !expiresAt || new Date().getTime() > parseInt(expiresAt)) {
          window.location.href = './src/auth.html';
          return false;
        }
        
        // Afficher l'interface une fois l'authentification vérifiée
        loadingScreen.style.display = 'none';
        app.style.display = 'flex';
        
        // Afficher les informations utilisateur
        if (userData) {
          try {
            const user = JSON.parse(userData);
            const twitchInfo = document.getElementById('twitch-info');
            if (twitchInfo && user) {
              twitchInfo.innerHTML = `
                <div class="user-profile">
                  ${user.profile_image_url ? `<img src="${user.profile_image_url}" alt="${user.display_name}">` : ''}
                  <span class="username">${user.display_name || 'Utilisateur Twitch'}</span>
                </div>
              `;
            }
          } catch (e) {
            console.error("Erreur lors de l'affichage des infos utilisateur", e);
          }
        }
        
        return true;
      };
      
      // Vérifier l'authentification au chargement
      checkAuth();
      
      // Gérer la déconnexion
      const logoutButton = document.getElementById('logout-button');
      if (logoutButton) {
        logoutButton.addEventListener('click', () => {
          localStorage.removeItem('twitch_token');
          localStorage.removeItem('twitch_expires_at');
          localStorage.removeItem('twitch_user');
          localStorage.removeItem('twitch_subscriber_count');
          localStorage.removeItem('twitch_subscriber_points');
          window.location.href = './src/auth.html';
        });
      }
    });
  </script>
  <footer>
    <div class="footer-links">
      <a href="/about.html">À propos</a>
      <span class="separator">|</span>
      <a href="/privacy.html">Politique de confidentialité</a>
    </div>
    <p>&copy; 2023 APO Overlays</p>
  </footer>
</body>
</html>